{%- macro categoryList(categories) -%}
{%- set comma = joiner() -%}
{%- for category in categories -%}
{{ comma() }} <a class="category-link" href="/categories/{{ category | slug }}">{{ category }}</a>
{%- endfor -%}
{%- endmacro -%}

{%- macro postList(posts) -%}
<div id="blog-archives">
  {% for post in posts | reverse %}

  {%- set this_year = post.data.date | getYear -%}

  {%- if year != this_year -%}
    {%- set year = this_year -%}
    <h2>{{year}}</h2>

  {% endif -%}

  <article>
    <h1><a href="{{ post.url }}">{{ post.data.title }}</a></h1>
    <time datetime="{{ post.date.toISOString() }}">{{ post.date | archiveDateHTML | safe }}</time>
    <footer>
      <a href="{{ post.url }}#commento">Comments</a>
      |
      <span class="categories">posted in {{ categoryList(post.data.tags) }}</span>
    </footer>
  </article>

  {% endfor %}
</div>
{%-endmacro -%}
